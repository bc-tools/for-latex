% == PACKAGES == %

\RequirePackage{fontawesome5}%
               [2022-05-02]

\RequirePackage{keytheorems}%
               [2024/09/19]

\RequirePackage{tcolorbox}%
               [2024/07/10]

\tcbuselibrary{breakable, skins}


% == TOOLS == %

% -- SOBER HIGHLIGHTING OF CONTENT -- %

% :: EXAMPLE - HIDDEN VERSIONS :: %

%%%
% See the \doc of the macro ''\newtheorem'' from the package ''amsthm''
% to have \infos about the environment ''@@tdocexa@nb''.
%%%
\newtheorem{@@tdocexa@nb}{\tutodoc@trans@exa@title}%
                         [subsubsection]

%%%
% We redefine the counter associated to the environment ''@@tdocexa@nb''
% to obtain only one single arabic number.
%%%
\renewcommand{\the@@tdocexa@nb}{\arabic{@@tdocexa@nb}}


%%%
% See the \doc of the macro ''\newtheorem*'' from the package ''amsthm''
% to have \infos about the environment ''@@tdocexa@no@nb''.
%%%
\newtheorem*{@@tdocexa@no@nb}{\tutodoc@trans@exa@title}


% :: EXAMPLE - PUBLIC VERSION :: %

\ExplSyntaxOn

\msg_set:nnnn { tdoc } { env-tdocexa-unknown-option }
  { Unknown ~ rafters ~ option. }
  { See ~ the ~ documentation ~ for ~ the ~ supported ~ options. }

\NewDocumentEnvironment{tdocexa}{D<>{nb} O{}}{
  \str_case:nnF { #1 } {
    { nb   } {
      \begin{@@tdocexa@nb}[#2]
    }
    { nonb } {
      \begin{@@tdocexa@no@nb}[#2]
    }
  }{
    \msg_error:nn { tdoc } { env-tdocexa-unknown-option }
  }
}{
  \str_case:nnF { #1 } {
    { nb   } {
      \end{@@tdocexa@nb}
    }
    { nonb } {
      \end{@@tdocexa@no@nb}
    }
  }{}
}

\ExplSyntaxOff


% :: REMARK :: %

%%%
% See the \doc of the macro ''\newtheorem*'' from the package ''amsthm''
% to have \infos about the environment ''tdocrem''.
%%%
\newtheorem*{tdocrem}{\tutodoc@trans@rem@title}


% -- COLORFUL HIGHLIGHTING OF CONTENT -- %

% :: ABSTRACTION :: %

% Sources used.
%    + https://tex.stackexchange.com/a/727022/6880
%    + https://tex.stackexchange.com/a/682332/6880

\tcbset{
  tutodoc-focus-color-style/.style = {
    breakable,
    enhanced,
%    fonttitle    = \itshape,
%    halign title = center,
    fontupper    = \color{#1!45!black},
    colback      = #1!5,
    colframe     = #1!75!black!45,
    shadow       = {.75mm}{-.75mm}{0mm}{black!30},
% We want to use the same color for the footnotes in the frame.
    before upper = {\let\default@color\current@color},
 }
}


% :: LET'S GO BACK TO THE REAL WORLD :: %

\ExplSyntaxOn

\prop_set_from_keyval:Nn \__g_tutodoc_focus_color_prop {
  note      = cyan,
  tip       = lime,
  important = orange,
  caution   = violet,
  warn      = red,
}

\prop_set_from_keyval:Nn \__g_tutodoc_focus_icon_prop {
  note      = \faInfoCircle,
  tip       = \faLightbulb,
  important = \faHighlighter,
  caution   = \faBiohazard,
  warn      = \faSkullCrossbones,
}

\prop_map_inline:Nn \__g_tutodoc_focus_color_prop {
  \newkeytheorem{tdoc#1}[
    numbered              = false,
%    tcolorbox-no-titlebar = {tutodoc-focus-color-style=#2},
    tcolorbox = {tutodoc-focus-color-style=#2},
    name                  = {
    	\prop_item:Nn \__g_tutodoc_focus_icon_prop { #1 } \kern3.5pt
	    \use:c { tutodoc@trans@#1@title }
	},
  ]
}

\ExplSyntaxOff
