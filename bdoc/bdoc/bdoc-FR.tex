\documentclass[12pt, a4paper]{article}

\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}

\usepackage[french]{babel, varioref}

\usepackage{enumitem}
\frenchsetup{StandardItemLabels=true}

% Package developped.
\usepackage[lang = french]{bdoc}


% Source.
%    * https://tex.stackexchange.com/a/604698/6880

\NewDocumentCommand{ \bdocdocextraruler }{ m }{%
    \par
    {
        \centering
        \color{green!50!black}%
        \leavevmode
        \kern.075\linewidth
        \leaders\hrule height3.25pt\hfill\kern0pt
        \footnotesize\itshape\bfseries\space\ignorespaces#1\unskip\space
        \leaders\hrule height3.25pt\hfill\kern0pt
        \kern.075\linewidth
        \par
    }
}

\NewDocumentEnvironment{ bdoc-doc-showcase }
                       { O{ Début du rendu dans cette doc. }
                         O{ Fin du rendu dans cette doc. } }{
%    \begin{colorstrip}{green!5}
        \bdocdocextraruler{#1}
        \smallskip
}{
        \smallskip
        \bdocdocextraruler{#2}
%    \end{colorstrip}
}


\begin{document}
\section{Introduction}

Le package \bdocpack{bdoc}
\footnote{
    Le nom vient de \bdocquote{\bdocprewhy{b.asic} \bdocprewhy{doc.umentation}} qui ne nécessite aucune traduction.
}
facilite la saisie sémantique de documentations de packages \LaTeX\ avec un rendu sobre pour une lecture sur écran
\footnote{
    L'idée est de produire un fichier \texttt{PDF} efficace à parcourir pour des besoins ponctuels. C'est généralement ce que l'on attend d'une documentation liée au codage.
},
mais pratique pour les utilisateurs (ce package propose, ou impose, un style de mise en forme, mais il n'a pas pour vocation à être transformé en une classe).


\section{Choisir la langue au chargement du package}

La présente documentation utilise le français via \bdocinlatex|\usepackage[lang = french]{bdoc}| .
Pour le moment, on a juste deux choix où la convention de nommage suit celle de \bdocpack{babel}.

\begin{enumerate}
    \item \bdocinlatex|english| est la valeur par défaut.

    \item \bdocinlatex|french| est pour \bdocinEN{français}.
\end{enumerate}


\section{Mises en forme générales imposées}

\subsection{Géométrie de la page}

Le package \bdocpack{geometry} est chargé avec les réglages suivants.

\begin{bdoclatex}[code]
\RequirePackage[
    top            = 2.5cm,
    bottom         = 2.5cm,
    left           = 2.5cm,
    right          = 2.5cm,
    marginparwidth = 2cm,
    marginparsep   = 2mm,
    heightrounded
]{geometry}
\end{bdoclatex}


%\section{Mises en forme générales imposées}

\subsection{Titre et table des matières}

Les packages \bdocpack{titlesec}, \bdocpack{tocbasic} et \bdocpack{bookmark} sont réglés comme suit où la redéfinition de \bdocmacro{thechapter} n'est utile que pour des packages agrégateurs (dont les documentations sont de type livre).

\begin{bdoclatex}[code]
\RequirePackage[raggedright]{titlesec}

% ...
\ifcsundef{chapter}%
          {}%
          {\renewcommand\thechapter{\Alph{chapter}.}}

\renewcommand\thesection{\Roman{section}.}
\renewcommand\thesubsection{\arabic{subsection}.}
\renewcommand\thesubsubsection{\roman{subsubsection}.}

\titleformat{\paragraph}[hang]%
            {\normalfont\normalsize\bfseries}%
            {\theparagraph}{1em}%
            {}

\titlespacing*{\paragraph}%
              {0pt}%
              {3.25ex plus 1ex minus .2ex}%
              {0.5em}

% Source
%    * https://tex.stackexchange.com/a/558025/6880
\DeclareTOCStyleEntries[
    raggedentrytext,
    linefill = \hfill,
    indent   = 0pt,
    dynindent,
    numwidth = 0pt,
    numsep   = 1ex,
    dynnumwidth
]{tocline}{
    chapter,
    section,
    subsection,
    subsubsection,
    paragraph,
    subparagraph
}

\DeclareTOCStyleEntry[indentfollows = chapter]{tocline}{section}
\end{bdoclatex}


%\section{Mises en forme générales imposées}

\subsection{Liens dynamiques}

Les packages \bdocpack{hyperref} et  \bdocpack{hyperref} sont aussi importés en coulisse avec les réglages ci-dessous.

\begin{bdoclatex}[code]
\hypersetup{
    colorlinks,
    citecolor = orange!75!black,
    filecolor = orange!75!black,
    linkcolor = orange!75!black,
    urlcolor  = orange!75!black
}
\end{bdoclatex}


\section{Indiquer des packages, des macros ou des environnements}

Voici ce qu'il est possible de taper de façon sémantique.

\begin{bdoclatex}[sbs]
\bdocpack{monpackage} est pour...

\bdocmacro{unemacro} permet de...

\bdocenv{env} sert à...
\end{bdoclatex}


\begin{bdocrem}
    L'intérêt des macros précédentes vis à vis de l'usage de \bdocmacro{bdocinlatex} est l'absence de coloration.
    De plus, la macro \bdocmacro{bdocenv} demande juste de taper le nom de l'environnement
    \footnote{
        De plus, \bdocinlatex{\bdocenv{monenv}} produit \bdocenv{monenv} avec des espaces afin d'autoriser des retours à la ligne si besoin.
    }.
\end{bdocrem}


% -------------------- %


\section{Origine d'un préfixe ou d'un suffixe}

Pour expliquer les noms retenus, rien de tel que d'indiquer et expliciter les courts préfixes et suffixes retenus. Ceci se fait facilement comme suit.

\begin{bdoclatex}[sbs]
\bdocpre{sup} est relatif à...

\bdocprewhy{sup.erbe} signifie...

\emph{\bdocprewhy{sup.er} pour...}
\end{bdoclatex}


\begin{bdocrem}
	Le choix du point pour scinder un mot permet d'utiliser des mots avec un tiret comme dans \bdocinlatex+\bdocprewhy{ca.sse-brique}+ qui donne \bdocprewhy{ca.sse-brique}.
\end{bdocrem}


\section{Cela veut dire quoi en \bdocquote{angliche}}

Penser aux non-anglophones est bien, même si ces derniers se font de plus en plus rares.

\begin{bdoclatex}
Cool et top signifient \bdocinEN*{cool} et \bdocinEN{top}.
\end{bdoclatex}


La macro \bdocmacro{bdocinEN} et sa version étoilée s'appuient sur \bdocmacro{bdocquote} : par exemple, le code \bdocinlatex|\bdocquote{sémantique}| produit \bdocquote{sémantique}.


\section{Un rendu en situation réelle} \label{bdoc-showcase}

\subsection{Avec une bande colorée}

\begin{bdocexa}[Avec les textes par défaut]
    Il peut être utile de montrer un rendu réel directement dans un document.
    Ceci se tape comme suit.

    \bdoclatexinput[code]{examples/showcase/default.tex}

	On obtient alors le rendu suivant
	\footnote{
    	La bande est créée sans effort grâce au package \bdocpack{clrstrip}.
	}.

	\medskip

	\input{examples/showcase/default.tex}
\end{bdocexa}


\begin{bdocrem}
	Voir la section \ref{bdoc-latexshow} pour obtenir facilement un code suivi de son rendu réel comme dans l'exemple précédent.
\end{bdocrem}


\begin{bdocnote}
	Il faut savoir qu'en coulisse la macro \bdocmacro{bdocruler} est utilisée.

    \begin{bdoclatex}[std]
    	\bdocruler{Un pseudo-titre décoré}{red}
	\end{bdoclatex}
\end{bdocnote}


% ------------------ %


\begin{bdocexa}[Changer la couleur et/ou les textes par défaut]
	\leavevmode

	\bdoclatexinput[code]{examples/showcase/customized.tex}

	Ceci produira ce qui suit.

	\medskip

	\input{examples/showcase/customized.tex}
\end{bdocexa}


\begin{bdocnote}
    \leavevmode

    \begin{itemize}
    	\item Les textes explicatifs s'adaptent à la langue choisie lors du chargement de \bdocpack{bdoc}.

    	\item Vous avez sûrement noté que l'on n'obtient pas un rouge pur : en coulisse les macros développables \bdocmacro{bdocbackcolor} et \bdocmacro{bdocdarkcolor} sont utilisées pour créer, à partir de la couleur proposée à \bdocenv{bdocshowcase}, celle du fond et celle des titres respectivement.
	          Ces macros à un seul argument, la couleur choisie, admettent les codes suivants.

		      \begin{bdoclatex}[code]
\NewExpandableDocumentCommand{\bdocbackcolor}{m}{#1!5}

\NewExpandableDocumentCommand{\bdocdarkcolor}{m}{#1!50!black}
		      \end{bdoclatex}
    \end{itemize}
\end{bdocnote}


% ------------------ %


\begin{bdocwarn}
    Avec la mise en forme par défaut, si le code \LaTeX\ commence par un crochet ouvrant, il faudra indiquer explicitement une option vide comme dans l'exemple suivant.

	\bdoclatexinput[code]{examples/showcase/hook.tex}

	Ceci produira ce qui suit.

	\medskip

	\input{examples/showcase/hook.tex}
\end{bdocwarn}


% ------------------ %


\subsection{Sans bande colorée}

Le rendu de \bdocenv{bdocshowcase} avec une bande colorée peut parfois ne pas être acceptable malgré le travail fait par \bdocpack{clrstrip}.
Voyons comment contourner ce type de limitation.

\begin{bdocexa}
	L'option booléenne \bdocinlatex{nostripe} sert à ne pas employer \bdocpack{clrstrip}.
	Voici un exemple d'utilisation.

	\bdoclatexinput[code]{examples/showcase/no-clrstrip.tex}

	Ceci produira ce qui suit.

	\medskip

	\input{examples/showcase/no-clrstrip.tex}
\end{bdocexa}


% ------------------ %


\begin{bdocexa}[Changer la couleur et/ou les textes par défaut]
	\leavevmode

	\bdoclatexinput[code]{examples/showcase/no-clrstrip-customized.tex}

	Ceci produira ce qui suit.

	\medskip

	\input{examples/showcase/no-clrstrip-customized.tex}
\end{bdocexa}


% ------------------ %


\subsection{En important le code \LaTeX}

\begin{bdocexa}<nonb>
	Pour obtenir des rendus en important le code depuis un fichier externe, au lieu de le taper, il suffit d'employer la macro \bdocmacro{bdocshowcaseinput} dont l'option reprend la syntaxe de celle de \bdocenv{bdocshowcase} et l'argument obligatoire donne le chemin du fichier.

	\medskip

	Ce qui suit a été obtenu via \bdocinlatex+\bdocshowcaseinput{examples/external.tex}+.

	\medskip

	\bdocshowcaseinput{examples/showcase/external.tex}

	\medskip

	Via \bdocinlatex+\bdocshowcaseinput[color = orange]{examples/external.tex}+ , on change la coloration comme suit.

	\medskip

	\bdocshowcaseinput[color = orange]{examples/showcase/external.tex}
\end{bdocexa}


\section{Cas d'utilisation en \LaTeX}

\subsection{Codes \bdocquote{en ligne}}

La macro \bdocmacro{bdocinlatex} permet de taper du code en ligne via un usage similaire à \bdocmacro{verb}.
Voici deux exemples d'utilisation.

\begin{enumerate}
    \item \bdocinlatex+\bdocinlatex|$a^b = c$|+ produit \bdocinlatex|$a^b = c$| .

    \item \bdocinlatex+\bdocinlatex|$a^b = c$|+ vient de \bdocinlatex#\bdocinlatex+\bdocinlatex|$a^b = c$|+# obtenu via \bdocinlatex@\bdocinlatex#\bdocinlatex+\bdocinlatex|$a^b = c$|+#@ ... etc.
\end{enumerate}


\begin{bdocimportant}
    La macro \bdocmacro{bdocinlatex} est utilisable dans une note de pied de page. En voici la preuve
    \footnote{
    	\bdocinlatex+$minted = TOP$+ a été tapé \bdocinlatex|\bdocinlatex+$minted = TOP$+| dans cette note de bas de page..
    }.
\end{bdocimportant}


\begin{bdocrem}
    Le nom de la macro \bdocmacro{bdocinlatex} vient de \bdocquote{\bdocprewhy{in.line} \LaTeX} soit \bdocinEN{\LaTeX\ en ligne}.
\end{bdocrem}


% ------------------ %


\subsection{Codes tapés directement}

\begin{bdocexa}[Face à face]
	Dans le code suivant, l'option \bdocinlatex#sbs# est pour \bdocquote{\bdocprewhy{s.ide} \bdocprewhy{b.y} \bdocprewhy{s.ide}} soit \bdocinEN{côte à côte}.

	\bdoclatexshow{examples/listing/ABC.tex}
\end{bdocexa}


% ------------------ %


\begin{bdocexa}[À la suite]
	L'environnement \bdocenv{bdoclatex} choisit par défaut l'option \bdocinlatex#std#
	\footnote{
    	\bdocinlatex{std} fait référence au comportement \bdocquote{standard} de \bdocpack{tcolorbox} vis à vis de la librairie \bdocpack{minted}.
	}
	et produit le résultat suivant.

	\begin{bdoclatex}
		$A = B + C$
	\end{bdoclatex}
\end{bdocexa}


% ------------------ %


\begin{bdocexa}[Juste le code]
	Afficher le code seul comme ci-après s'obtient via l'option \bdocinlatex#code# de l'environnement \bdocenv{bdoclatex}.

	\begin{bdoclatex}[code]
    	$A = B + C$
	\end{bdoclatex}
\end{bdocexa}


% ------------------ %


\begin{bdocwarn}
	Avec la mise en forme par défaut, si le code commence par un crochet ouvrant, il faudra indiquer explicitement l'option par défaut. Voici un cas d'usage.

	\bdoclatexshow[explain = Ceci permet d'obtenir ce qui est attendu :]
	              {examples/listing/strange.tex}
\end{bdocwarn}


%\section{Cas d'utilisation en \LaTeX}

\subsection{Codes importés}

Pour les codes suivants, on considère un fichier \verb+examples/listing/xyz.tex+ dont le chemin est donné relativement au document présent.
Le contenu de ce fichier se réduit à l'unique ligne \bdocinlatex|$x y z = 1$| .

\medskip

Noter ci-après que la macro \bdocmacro{bdoclatexinput} s'utilise de façon semblable à l'environnement \bdocenv{bdoclatex} excepté que l'on fournit le chemin d'un fichier.


% ------------------ %


\begin{bdocexa}[Face à face]
	\leavevmode

	\begin{bdoclatex}[code]
\bdoclatexinput[sbs]{examples/listing/xyz.tex}
	\end{bdoclatex}

	Ceci produit la mise en forme suivante.

	\bdoclatexinput[sbs]{examples/listing/xyz.tex}
\end{bdocexa}


% ------------------ %


\begin{bdocexa}[À la suite]
	\leavevmode

	\begin{bdoclatex}[code]
\bdoclatexinput{examples/listing/xyz.tex}
	\end{bdoclatex}

	Ceci produit la mise en forme suivante où l'option employée par défaut est \bdocinlatex#std#.

	\bdoclatexinput{examples/listing/xyz.tex}
\end{bdocexa}


% ------------------ %


\begin{bdocexa}[Juste le code]
	\leavevmode

	\begin{bdoclatex}[code]
\bdoclatexinput[code]{examples/listing/xyz.tex}
	\end{bdoclatex}

	Ceci produit la mise en forme suivante.

	\bdoclatexinput[code]{examples/listing/xyz.tex}
\end{bdocexa}


% ------------------ %


\subsection{Codes importés et mis en situation} \label{bdoc-latexshow}

Ce qui suit est utile pour des exemples plus sophistiqués.

\begin{bdocexa}[Showcase]
	Ce qui suit a été obtenu via la macro \bdocmacro{bdoclatexshow} en tapant \bdocinlatex+\bdoclatexshow{examples/listing/xyz.tex}+.

	\medskip

	\begin{bdoc-doc-showcase}
    	\bdoclatexshow{examples/listing/xyz.tex}
	\end{bdoc-doc-showcase}
\end{bdocexa}


% ------------------ %


\begin{bdocexa}[Changer le texte explicatif]
	Pour obtenir ce qui suit avec un texte personnalisé, il suffit d'employer \bdocinlatex|\bdoclatexshow[explain = Voici le rendu réel.]{...}|.

	\medskip

	\begin{bdoc-doc-showcase}
    	\bdoclatexshow[explain = Voici le rendu réel.]{examples/listing/xyz.tex}
	\end{bdoc-doc-showcase}
\end{bdocexa}


% ------------------ %


\begin{bdocnote}
    Le texte imprimé par défaut tient compte de la langue choisie lors du chargement du package \bdocpack{bdoc}.
\end{bdocnote}


% ------------------ %


\begin{bdocexa}[Les options disponibles]
	En plus du texte explicatif, il est aussi possible d'utiliser toutes les options de \bdocenv{bdocshowcase}, voir \ref{bdoc-showcase}.
	Voici un exemple illustrant ceci.

	\medskip

	\bdoclatexinput[code]{examples/listing/latexshow-options.tex}

	\medskip

	Ceci va produire ce qui suit.

	\medskip

	\begin{bdoc-doc-showcase}
    	\input{examples/listing/latexshow-options.tex}
	\end{bdoc-doc-showcase}
\end{bdocexa}


\section{Mettre en avant du contenu}

\begin{bdocnote}
	Les environnements présentés dans cette section
	\footnote{
		La mise en forme provient du package \bdocpack{amsthm}.
	}
	ajoutent un court titre indiquant le type d'informations fournies.
	Ce court texte sera toujours traduit dans la langue indiquée lors du chargement du package \bdocpack{bdoc}.
\end{bdocnote}


% ------------------ %


\subsection{Des exemples}

Des exemples numérotés, ou non, s'indiquent via l'environnement \bdocenv{bdocexa} qui propose deux arguments optionnels.

\begin{enumerate}
	\item Le 1\ier{} argument entre chevrons \verb#<...># peut prendre au choix les valeurs \verb#nb# pour numéroter, valeur par défaut, \verb#nonb# pour ne pas numéroter.

	\item Le 2\ieme{} argument entre crochets \verb#[...]# sert à ajouter un mini-titre.
\end{enumerate}


Voici différents emplois possibles.

\bdoclatexinput[sbs]{examples/focus/exa.tex}


% ------------------ %


\begin{bdocimportant}
	La numérotation des exemples est remise à zéro dès qu'une section  de niveau au moins égale à une \bdocinlatex|\subsubsection| est ouverte.
\end{bdocimportant}


% ------------------ %


\begin{bdoctip}
	Il peut parfois être utile de revenir à la ligne dès le début du contenu. Voici comment faire (ce tour de passe-passe reste valable pour les environnements présentés dans les sous-sections suivantes). Noter au passage que la numérotation suit celle de l'exemple précédent comme souhaité.

	\bdoclatexinput[sbs]{examples/focus/exa-leavevmode.tex}
\end{bdoctip}


%\section{Mettre en avant du contenu}

\subsection{Des remarques}

Tout se passe via l'environnement \bdocenv{bdocrem} comme dans l'exemple suivant.

\bdoclatexinput[sbs]{examples/focus/rmk.tex}


%\section{Mettre en avant du contenu}

\subsection{Une astuce}

L'environnement \bdocenv{bdoctip} sert à donner des astuces. Voici comment l'employer.

\bdoclatexinput[sbs]{examples/focus/tip.tex}


%\section{Mettre en avant du contenu}

\subsection{Note informative}

L'environnement \bdocenv{bdocnote} sert à mettre en avant des informations utiles. Voici comment l'utiliser.

\bdoclatexinput[sbs]{examples/focus/note.tex}


%\section{Mettre en avant du contenu}

\subsection{Un truc important}

L'environnement \bdocenv{bdocimportant} permet d'indiquer quelque chose d'important mais sans danger.

\bdoclatexinput[sbs]{examples/focus/important.tex}


%\section{Mettre en avant du contenu}

\subsection{Avertir d'un point très délicat}

L'environnement \bdocenv{bdoccaution} sert à indiquer un point délicat à  l'utilisateur. Voici comment l'employer.

\bdoclatexinput[sbs]{examples/focus/caution.tex}


%\section{Mettre en avant du contenu}

\subsection{Avertir d'un danger}

L'environnement \bdocenv{bdocwarn} sert à avertir l'utilisateur d'un piège à éviter. Voici comment l'employer.

\bdoclatexinput[sbs]{examples/focus/warn.tex}


\section{Changements}

\begin{bdocexa}[Expliquer dans le journal]
	Pour fournir des explications efficaces dans l'historique des changements, \bdocpack{bdoc} propose de procéder comme suit.

    \bdoclatexshow{examples/version-n-change/topic.tex}
\end{bdocexa}


% ------------------ %


\begin{bdocexa}[Dater des nouveautés]
    Pour indiquer la date d'une nouveauté, il suffit d'employer la macro \bdocmacro{bdocdate} comme dans l'exemple suivant où la date doit être donnée au format anglais \texttt{AAAA-MM-JJ}.

    \bdoclatexshow{examples/version-n-change/dating.tex}
\end{bdocexa}


% ------------------ %


\begin{bdocexa}[Versionner et dater des nouveautés]
	L'exemple suivant montre une macro plus complète que la précédente, à savoir \bdocmacro{bdocversion}.

	\bdoclatexshow{examples/version-n-change/versioning.tex}
\end{bdocexa}


\begin{bdocimportant}
    \leavevmode

    \begin{enumerate}
        \item Les macros \bdocmacro{bdocdate} et \bdocmacro{bdocversion} nécessitent deux compilations.

        \item Comme la langue indiquée pour cette documentation est le français, la date dans le rendu final est au format \texttt{JJ/MM/AAAA} alors que dans le code celle-ci devra toujours être donnée au format anglais \texttt{AAAA-MM-JJ}.

        \item Le numéro de version sera du type \texttt{maj.min.bug} ou \texttt{maj.min.bug-extra} avec trois entiers \texttt{maj}, \texttt{min}, \texttt{bug} et un optionnel \texttt{extra} égal à \texttt{alpha}, \texttt{beta} ou \texttt{rc} pour \bdocquote{release candidate}.
    \end{enumerate}
\end{bdocimportant}


\begin{bdocwarn}
	Seul l'emploi du format \bdocinlatex+YYYY-MM-DD+ est vérifié
	\footnote{
		Techniquement, vérifier la validité d'une date, via \LaTeX3, ne présente pas de difficulté.
	},
	et ceci est un choix ! Pourquoi cela ? Tout simplement car dater et versionner des explications doit se faire de façon semi-automatisée afin d'éviter tout bug humain
	\footnote{
		L'auteur de \bdocpack{bdoc} est entrain de mettre en place un ensemble d'outils permettant une telle semi-automatisation.
	}.
\end{bdocwarn}


\section{Décorations}

Finissons cette documentation avec de petites outils de mise en forme qui rendent de grands services.

\begin{bdoclatex}[sbs]
Bla, bla, bla...

\bdocsep % Pratique pour délimiter.

Ble, ble, ble...

Bli, bli, bli...

\bdocxspace % Espace subtile
            % mais utile.

Blo, blo, blo...

Blu, blu, blu...

\end{bdoclatex}
\end{document}
